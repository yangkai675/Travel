前端输入参数（DTO）
public class TravelRequest {
private String fromCity;        // 出发城市（如 "太原市"）
private String toCity;          // 目的地城市（如 "博尔塔拉蒙古自治州"）
private int days;               // 游玩天数（1~7）
private String startDate;      // 出发日期（YYYY-MM-DD）
private int people;             // 人数（1~10）
private String transport;       // 出行方式：高铁 / 飞机 / 自驾 / 高铁+租车
private double budget;          // 总预算（元）
private String specialNeeds;    // 特殊需求（可选，如 "带老人"、"想看日出"）
}
后端核心服务
public String generateTravelPlan(TravelRequest request) {
// 1. 标准化城市名（去“市”字，用于 API 查询）
String from = normalizeCity(request.getFromCity()); // "太原"
String to = normalizeCity(request.getToCity());     // "博尔塔拉"

    // 2. 并行查询各模块数据
    TransportOption transportOption = queryTransport(from, to, request.getTransport());
    List<Hotel> hotels = queryHotels(to, request.getDays(), request.getBudget());
    List<Attraction> attractions = queryAttractions(to);
    
    // 3. 构造 Prompt
    String prompt = buildPrompt(request, transportOption, hotels, attractions);

    // 4. 调用 AI
    return aiService.generate(prompt);
}
各模块数据查询逻辑
4.1 交通方案查询（queryTransport）
输入：
出发地、目的地、出行方式、当前日期
逻辑：
出行方式	调用 API	筛选规则
高铁/火车	阿里云火车票 API	有余票 + 座位类型匹配 + 时间早 + 价格合理 → 取 Top 2
飞机	机票聚合 API	经济舱 + 含税价 ≤ 预算×0.4 → 取最便宜 2 班
自驾	不调用 API	返回固定提醒文案
无直达处理：
若火车/飞机无直达 → 自动生成 1 个转乘方案（中转站：郑州/武汉）
明确标注：⚠️ 以下为参考转乘方案（非官方推荐，仅供参考）
输出示例（Java 对象）：
java
编辑
public class TransportOption {
boolean isDirect;
String type; // "高铁" / "飞机" / "自驾"
List<Segment> segments; // 1段（直达）或2段（转乘）
String disclaimer; // 转乘时填充免责声明
}
4.2 酒店查询（queryHotels）
输入：
目的地城市、游玩天数、总预算
调用：
高德地图 POI API 或 美团开放平台
筛选规则：
评分 ≥ 4.6
价格 ≤ (总预算 × 0.3) / 天数
距离市中心或主要景点 ≤ 5km
取 Top 3
输出：
java
编辑
List<Hotel> {
name: "博尔塔拉大酒店",
pricePerNight: 320,
score: 4.8,
distanceToCenter: "1.2km"
}
4.3 景点查询（queryAttractions）
调用：
高德地图 Web API（免费，3万次/日）
请求示例：
http
编辑
GET https://restapi.amap.com/v5/place/text?
key=YOUR_KEY&
keywords=景点&
city=博尔塔拉&
types=风景名胜|自然风光&
sortby=rating:1&
offset=20
筛选规则：
评分 ≥ 4.3
门票价格已知
开放状态为“营业中”
取 Top 5
输出：
java
编辑
List<Attraction> {
name: "赛里木湖",
score: 4.8,
ticketPrice: 70,
description: "大西洋最后一滴眼泪",
openTime: "08:00-20:00"
}
⚠️ 绝不允许 AI 自由编造景点！所有推荐必须来自此列表。
Prompt 构造模板（关键！）
【用户需求】
- 出发地：{{fromCity}}
- 目的地：{{toCity}}
- 游玩 {{days}} 天，{{people}} 人
- 总预算：¥{{budget}}
- 出行方式：{{transport}}
- 特殊需求：{{specialNeeds}}

【交通方案】
{{#if transportOption.isDirect}}
✅ 推荐直达：
- {{transportOption.segments[0].summary}}
  {{else}}
  ⚠️ 无直达，参考转乘方案（非官方推荐，仅供参考）：
- {{transportOption.disclaimer}}
  {{/if}}

【酒店推荐】（按性价比排序）
{{#each hotels}}
- {{name}}：¥{{pricePerNight}}/晚，评分 {{score}}，距景区 {{distanceToCenter}}
  {{/each}}

【必游景点】（来自高德地图真实数据）
{{#each attractions}}
- {{name}}（¥{{ticketPrice}}）：{{description}}，开放时间 {{openTime}}
  {{/each}}

【要求】
1. 用亲切、朋友般的语气写攻略
2. 规划每日行程（上午/下午/晚上）
3. 分配预算（交通/住宿/餐饮/门票）
4. 加入实用提醒（天气、高原、防骗等）
5. 不要编造未列出的景点或酒店
6. 结尾鼓励用户，并提示“信息仅供参考，请以实际为准”
特殊场景处理
   6.1 自驾模式
   不查询车次/航班
   在 Prompt 中注入固定提醒：
   text
   编辑
   🚗 自驾专属提醒：
- 全程约 XXX 公里，建议分 X 天行驶
- 提前下载高德离线地图
- 备足燃油、水、应急工具
- 注意高原反应和天气变化
  6.2 预算不足
  若交通+住宿 > 预算 × 0.8 → 在 Prompt 中提示：
  text
  编辑
  💡 当前预算较紧张，已优先推荐经济型方案。建议适当增加预算或缩短天数。
  七、输出格式
  返回格式：纯文本（Markdown 兼容）
  前端展示：微信小程序 rich-text 或 textarea
  示例片段：
  markdown
  编辑
  🚆 **交通推荐**：坐 Dxxx 高铁（10:15出发，票价 ¥520）...

🏨 **住宿推荐**：金源宾馆，¥260/晚，评分 4.6...

⚠️ **重要提醒**：博尔塔拉海拔较高，请注意防寒防晒！
八、外部 API 清单（需申请）
功能	推荐服务商	成本	备注
火车/高铁查询	阿里云市场（如“聚合数据”）	¥0.02/次	支持座位类型过滤
机票查询	阿里云航旅 API / 飞常准	¥0.05/次	可选
酒店 & 景点	高德地图 Web API	免费（3万次/日）	必需
大模型	Qwen / Kimi / DeepSeek	免费额度充足	核心
九、安全与合规
所有交通/酒店信息标注 “仅供参考，请以官方为准”
不提供购票/订房跳转链接（或仅提供 H5 外链）
不存储用户隐私数据
符合微信小程序审核规范
十、MVP 开发建议
模块	MVP 是否做	说明
直达火车查询	✅	核心
转乘方案	✅（兜底1个）	用郑州中转
酒店推荐	✅	高德 API
景点推荐	✅	高德 API
飞机查询	❌	后期加
多日详细行程	✅	AI 生成

